name: Node.js Workflow

on: [push]  # Trigger the workflow on push events

jobs:
  run-node:
    runs-on: ubuntu-latest  # Use the latest Ubuntu environment

    steps:
      - uses: actions/checkout@v3  # Checkout the repository
      - uses: actions/setup-node@v4  # Set up Node.js
        with:
          node-version: 16  # Specify the Node.js version
      - run: cd ..  # Change directory to the parent directory
      - run: echo "listen" | node start.js  # Write "listen" to console input

  deploy-static-content:
    runs-on: ubuntu-latest
    needs: [run-node]  # Wait for the Node.js workflow to finish before deploying

    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Setup Pages
        uses: actions/configure-pages@v5
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          # Upload entire repository
          path: '.'
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4